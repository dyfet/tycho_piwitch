#!/bin/sh
### BEGIN INIT INFO
# Provides:             piwitch
# Requires-Start:       $remote_fs $syslog $networking sipwitchqt-server
# Requires-Stop:        $remote_fs $syslog $networking sipwitchqt-server
# Default-Start:        2 3 4 5
# Default-Stop:         0 1 6
# Short Description:    piwitch service
# Description:          
### END INIT INFO

PATH=/usr/local/bin:/usr/local/sbin/:/sbin:/usr/sbin:/bin:/usr/bin
DESC="piwitch rack web server"
NAME=piwitch
DAEMON={{rack_install_prefix}}/piwitch
SCRIPTNAME=/etc/init.d/$NAME
PIDPATH=/tmp/piwitch.pid

. /lib/lsb/init-functions

case "$1" in
start)
	echo -n "Starting $DESC: "
    start-stop-daemon --start --quiet --background \
        --group sipwitch --chuid sipwitch:sipwitch --exec $DAEMON &>/dev/null
    echo "$NAME."
    ;;
stop)
    echo -n "Stopping $DESC: "
    [ -n "$PID" ] && start-stop-daemon --stop --quiet \
        --retry=TERM/30/KILL/5 --pidfile $PID --remove-pidfile
    echo "$NAME."
    ;;
status)
    if test -f "$PIDPATH" ; then
        echo "$NAME running."
        exit 0
    else
        echo "$NAME stopped."
        exit 3
    fi
    ;;	
restart|force-reload)
    $0 stop
    $0 start
    ;;
try-restart)
    if test -f "$PIDFILE" ; then
        $0 stop
        $0 start
    else
        echo "Inactive $DESC: $NAME."
    fi
    ;;
*)
    echo "Usage: $0 {start|stop|restart|force-reload|try-restart|status}" >&2
    exit 1
    ;;
esac


